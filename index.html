<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Benchmark DI</title>
    <script type="text/javascript" src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
        google.load("visualization", "1", {packages:["corechart"]});
        $(function () {
            var options = {
                    height: 300,
                    series: [
                        {targetAxisIndex: 0, color: '#FF3333'}, // memory
                        {targetAxisIndex: 1, color: '#FF9900'}, // time
                        {targetAxisIndex: 3, color: '#CCCC99', opacity: 0.5}, // code lines
                        {targetAxisIndex: 2, color: '#CCCCCC', opacity: 0.5}, // files included
                        {targetAxisIndex: 4, color: '#87CEEB', opacity: 0.5} // cycles collected
                    ],
                    vAxes: [
                        {textStyle: {color: '#FF3333'}}, // memory
                        {textStyle: {color: '#FF9900'}}, // time
                        {textPosition: 'none', gridlines: { color: 'transparent'}}, // code lines
                        {textPosition: 'none',  gridlines: { color: 'transparent'}}, // files included
                        {textPosition: 'none', gridlines: { color: 'transparent'}} // cycles collected
                    ]
                },
                $graphs = $('div.graph')
                    .each(function () {
                        var $self = $(this);
                        $self.data({
                            graph: google.visualization.arrayToDataTable($self.data('results')),
                            chart: new google.visualization.ColumnChart(this)
                        });
                    })
            ;
            $('#fixedView')
                .on('change', function () {
                    var settings = this.checked ?
                        $.extend(true, {}, options, {
                            vAxes: [
                                {viewWindowMode:'explicit', viewWindow: {min: 0, max:5}}, // memory
                                {viewWindowMode:'explicit', viewWindow: {min: 0, max:1}}, // time
                                {viewWindowMode:'explicit',  viewWindow: {min: 0, max:15}}, // code lines
                                {viewWindowMode:'explicit', viewWindow: {min: 0, max:30}}, // files included
                                {viewWindowMode:'explicit', viewWindow: {min: 0, max:13000}} // cycles collected
                            ]
                        }) :
                        options
                    ;
                    $graphs
                        .each(function () {
                            var chart = $.data(this, 'chart')
                              , graph = $.data(this, 'graph')
                            ;
                            chart.draw(graph, settings);
                        })
                    ;
                })
                .trigger('change')
            ;
        });
    </script>
</head>
<body>
    <label>
        <input type="checkbox" id="fixedView"/>
        Graphs use fixed Y axis values
    </label>

    <h1>Benchmark 1 : Auto resolution of object and dependencies (Aliasing Interfaces to Concretes).</h1>
    <div class="graph" data-results='[["Component","Memory usage for one test in kb","Time per test, average in \u00b5s","Lines of code","Approx. included files","Cycle collected after 200 tests"],["Aura",0.6875,0.15043020248413,5,6,4200],["Illuminate",1.03125,0.49620985984802,5,2,4400],["League",0.8828125,0.30508518218994,5,2,2600],["Orno",0.9609375,0.28923988342285,5,5,4800],["PHP-DI",1.0859375,0.38275003433228,7,29,7000],["Zend",1.7109375,1.0346853733063,5,25,0]]'></div>
    <ul>
            <li>Orno injected null  param to build Foo object (used default parameter?) : Benchmark\Stubs\Foo(
   'bar' => 
  Benchmark\Stubs\Bar(
     'baz' => 
    Benchmark\Stubs\Baz(
       'bam' => NULL
    )
  )
)</li>        <li>Zend injected null  param to build Foo object (used default parameter?) : Benchmark\Stubs\Foo(
   'bar' => NULL
)</li>        <li>PHP-DI injected null  param to build Foo object (used default parameter?) : Benchmark\Stubs\Foo(
   'bar' => NULL
)</li>        <li>Aura injected null  param to build Foo object (used default parameter?) : Benchmark\Stubs\Foo(
   'bar' => NULL
)</li>
    </ul>
    <br/><b>Memory peak : 3.75 Mb</b>
    
    <h1>Benchmark 2 : Auto resolution of object and dependencies (Register all objects with container).</h1>
    <div class="graph" data-results='[["Component","Memory usage for one test in kb","Time per test, average in \u00b5s","Lines of code","Approx. included files","Cycle collected after 200 tests"],["Aura",0.6875,0.20035982131958,8,6,6600],["Illuminate",1.03125,0.5613648891449,8,2,6800],["League",0.8359375,0.28840065002441,8,2,2600],["Orno",0.8203125,0.18929004669189,8,5,5400],["PHP-DI",1.0859375,0.51816463470459,10,29,8800],["Zend",2.140625,4.4626450538635,8,25,0]]'></div>
    <ul>
            <li>Orno injected null  param to build Foo object (used default parameter?) : Benchmark\Stubs\Foo(
   'bar' => NULL
)</li>        <li>PHP-DI injected null  param to build Foo object (used default parameter?) : Benchmark\Stubs\Foo(
   'bar' => NULL
)</li>        <li>Aura injected null  param to build Foo object (used default parameter?) : Benchmark\Stubs\Foo(
   'bar' => NULL
)</li>
    </ul>
    <br/><b>Memory peak : 4.5 Mb</b>
    
    <h1>Benchmark 3 : Factory closure resolution.</h1>
    <div class="graph" data-results='[["Component","Memory usage for one test in kb","Time per test, average in \u00b5s","Lines of code","Approx. included files","Cycle collected after 200 tests"],["Aura",0.6875,0.069960355758667,4,7,0],["Illuminate",1.03125,0.068515539169312,4,2,0],["League",0.6875,0.031964778900146,4,2,0],["Orno",0.8203125,0.084298849105835,4,6,1800],["PHP-DI",0.6875,0.24425387382507,7,31,6600],["Pimple",0.84375,0.055325031280518,4,1,0]]'></div>
    <ul>
    
    </ul>
    <br/><b>Memory peak : 4.5 Mb</b>
    
    <h1>Benchmark 4 : Constructor injection with defined arguments.</h1>
    <div class="graph" data-results='[["Component","Memory usage for one test in kb","Time per test, average in \u00b5s","Lines of code","Approx. included files","Cycle collected after 200 tests"],["Aura",0.6875,0.55516481399536,7,7,10400],["League",0.6875,0.24385571479797,8,2,4200],["Orno",0.8203125,0.35891532897949,8,6,6600],["PHP-DI",0.875,1.3869142532349,11,32,13200],["Symfony",0.921875,1.0673594474792,8,9,0],["Zend",2.140625,5.1647543907166,15,25,0]]'></div>
    <ul>
    
    </ul>
    <br/><b>Memory peak : 5.25 Mb</b>
    
    <h1>Benchmark 5 : Setter injection with defined setter methods.</h1>
    <div class="graph" data-results='[["Component","Memory usage for one test in kb","Time per test, average in \u00b5s","Lines of code","Approx. included files","Cycle collected after 200 tests"],["Aura",0.6875,0.63887476921082,7,7,11200],["League",0.6875,0.30197978019714,8,2,5000],["Orno",1.0234375,0.40484070777893,8,6,9000],["PHP-DI",1.1171875,1.5401792526245,11,32,14000],["Symfony",0.921875,1.2256598472595,16,9,0],["Zend",6.0859375,6.4711248874664,45,29,0]]'></div>
    <ul>
    
    </ul>
    <br/><b>Memory peak : 5.75 Mb</b>
    </body>
</html>
